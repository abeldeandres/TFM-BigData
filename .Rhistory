PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem    ))
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$GOS5 <- factor(datos.modelo$GOS5)
table(datos.modelo$abandona)
table(datos.modelo$GOS5)
summary(datos.modelo$GOS5)
summary(datos.modelo$GOS5)
datos.modelo$GOS5 <- factor(datos.modelo$GOS5)
head(datos.modelo)
summary(datos.modelo$GOS5)
#datos.modelo$GOS5 <- factor(datos.modelo$GOS5)
table(datos.modelo$GOS5)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
head(datos.modelo)
table(datos.modelo$GOS5)
library(ggplot2)
#
#library(ggplot2)
#ggplot(datos.modelo, aes(x = nivel_satisfaccion, y = ultima_evaluacion, color = abandona)) + geom_point()
datos.modelo$SEX <- factor(datos.modelo$SEX)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$SEX <- factor(datos.modelo$SEX)
table(datos.modelo$SEX)
summary(datos.modelo$SEX)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$PUPIL_REACT_LEFT <- factor(datos.modelo$PUPIL_REACT_LEFT)
table(datos.modelo$PUPIL_REACT_LEFT)
summary(datos.modelo$PUPIL_REACT_LEFT)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$PUPIL_REACT_RIGHT <- factor(datos.modelo$PUPIL_REACT_RIGHT)
table(datos.modelo$PUPIL_REACT_RIGHT)
summary(datos.modelo$PUPIL_REACT_RIGHT)
datos.modelo$pupils <- as.numeric(paste(datos.modelo$PUPIL_REACT_LEFT, datos.modelo$PUPIL_REACT_RIGHT, sep = ""))
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$pupils <- as.numeric(paste(datos.modelo$PUPIL_REACT_LEFT, datos.modelo$PUPIL_REACT_RIGHT, sep = ""))
datos.modelo$pupils <- factor(datos.modelo$pupils)
table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
#datos.modelo$pupils <- as.numeric(paste(datos.modelo$PUPIL_REACT_LEFT, datos.modelo$PUPIL_REACT_RIGHT, sep = ""))
datos.modelo$PUPIL_REACT_RIGHT <- factor(datos.modelo$PUPIL_REACT_RIGHT)
table(datos.modelo$PUPIL_REACT_RIGHT)
summary(datos.modelo$PUPIL_REACT_RIGHT)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$pupils <- paste(datos.modelo$PUPIL_REACT_LEFT, datos.modelo$PUPIL_REACT_RIGHT)
datos.modelo$pupils <- factor(datos.modelo$pupils)
table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$pupils <- aggdata <-aggregate(datos.modelo, by=list(PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT),
FUN=sum, na.rm=TRUE)
datos.modelo$pupils <- factor(datos.modelo$pupils)
table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$pupils <- aggdata <-aggregate(datos.modelo, by=list(PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT),
FUN=sum)
datos.modelo$pupils <- factor(datos.modelo$pupils)
table(datos.modelo$pupils)
summary(datos.modelo$pupils)
datos.modelo$pupils <-aggregate(datos.modelo, by=list(PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT),
FUN=sum)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
datos.modelo$pupils <-aggregate(datos.modelo, by=list(datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT),
FUN=sum)
datos.modelo$pupils <- factor(datos.modelo$pupils)
table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
aggregate(datos.modelo$pupils, by=list(datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT),
FUN=sum)
datos.modelo$pupils <- factor(datos.modelo$pupils)
table(datos.modelo$pupils)
summary(datos.modelo$pupils)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
aggregate(datos.modelo$pupils, by=list(datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT),
FUN=sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
FUN=sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
FUN=sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
#aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
#FUN=sum)
aggregate(pupils~PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT, datos.modelo, sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
#aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
#FUN=sum)
aggregate(PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT, datos.modelo, sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
#aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
#FUN=sum)
aggregate(datos.modelo$PUPIL_REACT_LEFT+datos.modelo$PUPIL_REACT_RIGHT, datos.modelo, sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
FUN=sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
#aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
#FUN=sum)
library(dplyr)
datos.modelo %>%
group_by(PUPIL_REACT_LEFT, PUPIL_REACT_RIGHT) %>%
summarise_each(funs(mean))
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
#aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
#FUN=sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
FUN=sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
#datos.modelo <- subset(CRASH.2_data_0, select = c(ientryid, isource, trandomised,ioutcomeid,isex,iage,ninjurytime,iinjurytype,isbp,irr,icc,ihr,igcseye,igcsmotor,igcsverbal,igcs,ddeath,icause,scauseother,istatus,ddischarge,icondition,ndaysicu,bheadinj,bneuro,bchest,babdomen,bpelvis,bpe,bdvt,bstroke,bbleed,bmi,bgi,bloading,bmaint,btransf,ncell,nplasma,nplatelets,ncryo,bvii,iboxid,ipacknum))
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
TH_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
head(datos.modelo)
#aggregate(datos.modelo$pupils, by=datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT,
#FUN=sum)
#datos.modelo$pupils <- factor(datos.modelo$pupils)
#table(datos.modelo$pupils)
summary(datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT)
table(datos.modelo$PUPIL_REACT_LEFT,datos.modelo$PUPIL_REACT_RIGHT)
if(!require(pROC)) install.packages("pROC")
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
EO_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
#nrow(datos.modelo) Tenemos 10008 pacientes
#Con esto limpiamos las variables de NA y campos vacios
datos.modelo <- datos.modelo[!is.na(datos.modelo$EO_Cause),]
datos.modelo <- datos.modelo[!is.na(datos.modelo$EO_Major.EC.injury),]
datos.modelo <- datos.modelo[datos.modelo$GOS5!="",]
datos.modelo$GOS5 <- as.character(datos.modelo$GOS5)
datos.modelo$GOS5[which(datos.modelo$GOS5=="D")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="SD")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="SD*")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="GR*")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="GR")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="MD*")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="MD")] <- "1"
datos.modelo$GOS5 <- as.numeric(datos.modelo$GOS5)
factor(datos.modelo$EO_Major.EC.injury)
#View(datos.modelo$GOS5)
#Vemos los valores nulos de cada variable
sapply(datos.modelo,function(x) sum(is.na(x)))
sapply(datos.modelo, function(x) length(unique(x)))
library(Amelia)
missmap(datos.modelo, main = "Missing values vs observed")
NROW(datos.modelo )
fit <- glm(factor(GOS5) ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo,family = binomial(link = "logit"))
summary(fit) # show results
#Akaike Information Criterio. The best model istheone withthe lowest AIC score
AIC(fit)
# Calculate Pseudo R-2
gos <- factor(datos.modelo$GOS5)
FullcovModel <- glm(datos.modelo$GOS5~0, family=binomial(link=logit))
1-(logLik(fit))/(logLik(FullcovModel))
#Random Forest model
rf <- randomForest(factor(GOS5) ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo)
# Model output
print(rf)
nova(fit, test="Chisq")
levels(as.factor(datos.modelo$GOS5))
#ROC
preds=predict(fit)
rocP<-roc(GOS5 ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo,levels=base::levels(as.factor(datos.modelo$GOS5)))
plot.roc(GOS5 ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo,levels=base::levels(as.factor(datos.modelo$GOS5)))
#roc(GOS5 ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo, smooth=TRUE)
#auc(rocP, partial.auc=FALSE, partial.auc.focus=c("specificity","sensitivity"), partial.auc.correct=FALSE,allow.invalid.partial.auc.correct = FALSE)
#BLEARN
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,GOS5))
data(datos.modelo)
bn.cv(datos.modelo, bn = "hc", algorithm.args = list(score = "bde", iss = 1))
if(!require(pROC)) install.packages("pROC")
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
EO_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
#nrow(datos.modelo) Tenemos 10008 pacientes
#Con esto limpiamos las variables de NA y campos vacios
datos.modelo <- datos.modelo[!is.na(datos.modelo$EO_Cause),]
datos.modelo <- datos.modelo[!is.na(datos.modelo$EO_Major.EC.injury),]
datos.modelo <- datos.modelo[datos.modelo$GOS5!="",]
datos.modelo$GOS5 <- as.character(datos.modelo$GOS5)
datos.modelo$GOS5[which(datos.modelo$GOS5=="D")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="SD")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="SD*")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="GR*")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="GR")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="MD*")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="MD")] <- "1"
datos.modelo$GOS5 <- as.numeric(datos.modelo$GOS5)
factor(datos.modelo$EO_Major.EC.injury)
#View(datos.modelo$GOS5)
#Vemos los valores nulos de cada variable
sapply(datos.modelo,function(x) sum(is.na(x)))
sapply(datos.modelo, function(x) length(unique(x)))
library(Amelia)
missmap(datos.modelo, main = "Missing values vs observed")
NROW(datos.modelo )
fit <- glm(factor(GOS5) ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo,family = binomial(link = "logit"))
summary(fit) # show results
if(!require(pROC)) install.packages("pROC")
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
EO_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
#nrow(datos.modelo) Tenemos 10008 pacientes
#Con esto limpiamos las variables de NA y campos vacios
datos.modelo <- datos.modelo[!is.na(datos.modelo$EO_Cause),]
datos.modelo <- datos.modelo[!is.na(datos.modelo$EO_Major.EC.injury),]
datos.modelo <- datos.modelo[datos.modelo$GOS5!="",]
datos.modelo$GOS5 <- as.character(datos.modelo$GOS5)
datos.modelo$GOS5[which(datos.modelo$GOS5=="D")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="SD")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="SD*")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="GR*")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="GR")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="MD*")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="MD")] <- "1"
datos.modelo$GOS5 <- as.numeric(datos.modelo$GOS5)
factor(datos.modelo$EO_Major.EC.injury)
#View(datos.modelo$GOS5)
#Vemos los valores nulos de cada variable
sapply(datos.modelo,function(x) sum(is.na(x)))
sapply(datos.modelo, function(x) length(unique(x)))
library(Amelia)
missmap(datos.modelo, main = "Missing values vs observed")
NROW(datos.modelo )
fit <- glm(factor(GOS5) ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo,family = binomial(link = "logit"))
summary(fit) # show results
setwd("C:/Users/Marta.Rodriguez/Desktop/TFM")
#ROC
preds=predict(fit)
if(!require(pROC)) install.packages("pROC")
CRASH_data_1 <- read.csv("C:/Users/Marta.Rodriguez/Desktop/TFM/CRASH_data-1.csv")
#View(CRASH_data_1)
datos.modelo <- subset(CRASH_data_1, select =
c(SEX,AGE,EO_Cause,EO_Major.EC.injury,GCS_EYE,GCS_MOTOR,GCS_VERBAL,
PUPIL_REACT_LEFT,PUPIL_REACT_RIGHT,EO_1.or.more.PH,
EO_Subarachnoid.bleed,EO_Obliteration.3rdVorBC,
EO_Midline.shift..5mm,EO_Non.evac.haem,EO_Evac.haem,GOS5    ))
#nrow(datos.modelo) Tenemos 10008 pacientes
#Con esto limpiamos las variables de NA y campos vacios
datos.modelo <- datos.modelo[!is.na(datos.modelo$EO_Cause),]
datos.modelo <- datos.modelo[!is.na(datos.modelo$EO_Major.EC.injury),]
datos.modelo <- datos.modelo[datos.modelo$GOS5!="",]
datos.modelo$GOS5 <- as.character(datos.modelo$GOS5)
datos.modelo$GOS5[which(datos.modelo$GOS5=="D")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="SD")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="SD*")] <- "0"
datos.modelo$GOS5[which(datos.modelo$GOS5=="GR*")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="GR")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="MD*")] <- "1"
datos.modelo$GOS5[which(datos.modelo$GOS5=="MD")] <- "1"
datos.modelo$GOS5 <- as.numeric(datos.modelo$GOS5)
factor(datos.modelo$EO_Major.EC.injury)
#View(datos.modelo$GOS5)
#Vemos los valores nulos de cada variable
sapply(datos.modelo,function(x) sum(is.na(x)))
sapply(datos.modelo, function(x) length(unique(x)))
library(Amelia)
missmap(datos.modelo, main = "Missing values vs observed")
NROW(datos.modelo )
fit <- glm(factor(GOS5) ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo,family = binomial(link = "logit"))
summary(fit) # show results
#Akaike Information Criterio. The best model istheone withthe lowest AIC score
AIC(fit)
# Calculate Pseudo R-2
gos <- factor(datos.modelo$GOS5)
FullcovModel <- glm(datos.modelo$GOS5~0, family=binomial(link=logit))
1-(logLik(fit))/(logLik(FullcovModel))
#Random Forest model
rf <- randomForest(factor(GOS5) ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo)
# Model output
print(rf)
nova(fit, test="Chisq")
levels(as.factor(datos.modelo$GOS5))
#ROC
preds=predict(fit)
rocP<-roc(GOS5 ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo,levels=base::levels(as.factor(datos.modelo$GOS5)))
plot.roc(GOS5 ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo,levels=base::levels(as.factor(datos.modelo$GOS5)))
#roc(GOS5 ~ SEX + AGE+GCS_EYE+GCS_MOTOR+GCS_VERBAL+PUPIL_REACT_LEFT+PUPIL_REACT_RIGHT,data=datos.modelo, smooth=TRUE)
#auc(rocP, partial.auc=FALSE, partial.auc.focus=c("specificity","sensitivity"), partial.auc.correct=FALSE,allow.invalid.partial.auc.correct = FALSE)
